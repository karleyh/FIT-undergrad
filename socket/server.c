/* * server.c * *  Created on: Mar 3, 2015 *      Author: Karley Herschelman *	calculates the factorial of the number sent by the client */#include<stdio.h>#include<string.h>#include<sys/socket.h>#include<arpa/inet.h>#include<unistd.h>int main(int argc , char *argv[]){	int sock_id , client_sock , struct_size , read_size;	struct sockaddr_in server , client;	int value;	//Create socket	sock_id = socket(AF_INET , SOCK_STREAM , 0);	if (sock_id < 0)	{		perror("Creating socket failed");	}	else	{		puts("Socket created");	}	//Prepare the sockaddr_in structure	server.sin_family = AF_INET;	server.sin_addr.s_addr = INADDR_ANY;	server.sin_port = htons( 5575 );	//Bind	if( bind(sock_id,(struct sockaddr *)&server , sizeof(server)) < 0)	{		//print the error message		perror("bind failed");		return 1;	}	puts("bind done successfully!");	//Listen	listen(sock_id , 3);	//Accept and incoming connection	puts("Waiting for client to connect...");	struct_size = sizeof(struct sockaddr_in);	//accept connection from an incoming client	client_sock = accept(sock_id, (struct sockaddr *)&client, (socklen_t*)&struct_size);	if (client_sock < 0)	{		perror("accept failed");		return 1;	}	puts("Connection accepted");	//Receive a message from client	while (read_size = recv(client_sock , &value , sizeof(value) , 0) > 0) //message received, loop allows for more than one message	{		int fact = 1;		int i;		for (i = 1; i <= value; i++)		{		    fact *= i;		}		write(client_sock , &fact, sizeof(fact)); //write value back to the client	}	if(read_size == 0) //no message received	{		puts("Client disconnected");		fflush(stdout);	}	else if(read_size == -1) //failure when receiving message	{		perror("receiving failed");	}	return 0;}